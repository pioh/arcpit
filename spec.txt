ARCPIT — кастомная игра Dota 2: рандом героев + рандом способностей с PvE раундами.
Цель: держать “ванильные” KV из клиента под git-дифф, накладывать реворк/оверрайды слоями, и хранить TS-логику рядом с сущностями (герой/способность/предмет).

1) Где что лежит
- src/vscripts/ — server-side TS → Lua (tstl)
  - GameMode.ts — вход/инициализация, обработчики событий, state flow
  - heroes/hero-draft-manager.ts — кастомный пик героя (офферы)
  - abilities/ability-draft-manager.ts — выбор способностей “по требованию”
  - rounds/round-controller.ts — PvE раунды и спавн крипов
  - kv_generated/autoload.ts — авто-импорт TS из kv/**/{modifiers,customizers} (генерится, не редактировать)

- kv/ — всё по сущностям в одной папке
  - heroes/<heroShort>/{01_dota,02_custom,03_custom,modifiers,customizers}/...
    - 01_dota/{npc,abilities} — ваниль из клиента (generated, коммитим)
    - 02_custom/{npc,abilities} — автоген после реворка (gitignored)
    - 03_custom/{npc,abilities} — ручные правки (коммитим)
    - modifiers/, customizers/ — ваш TS код (коммитим)
  - unassigned/<abilityName>/{01_dota,02_custom,03_custom,modifiers,customizers}/ability/<ability>.json
  - items/<itemName>/{01_dota,02_custom,03_custom,customizers}/item/<item>.json
  - transformers/*.js — глобальные трансформеры для сборки 02_custom

2) Команды
- bun run refresh:dota-kv — обновить kv/**/01_dota из установленной Dota 2 (VPK). Запускать вручную при патчах.
- bun run generate — НЕ тянет ваниллу; строит 02_custom, мержит с 03_custom, генерит:
  - game/scripts/npc/npc_{heroes,abilities,items}_custom.txt
  - src/vscripts/{heroes,abilities,items}/*/generated.ts (пулы для рандома; важно: без точек в имени файла из-за VScript require)
  - src/vscripts/kv_generated/autoload.ts (автоимпорт TS из kv)
- bun run build — сначала запускает generate, потом компилирует panorama+vscripts.

3) Игровой flow (кратко)
- CUSTOM_GAME_SETUP: добавляем ботов → кастомный пик героя → FinishCustomGameSetup()
- STRATEGY_TIME: стандартный UI аспектов
- GAME_IN_PROGRESS: старт сценария/раундов + выдача офферов выбора способностей